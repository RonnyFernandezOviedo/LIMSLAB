import{d as Q,al as z,P as J,r as u,ai as W,aj as X,L as B,Q as T,t as Y,o as i,c as d,e as N,f as r,v as Z,b as t,w as _,u as s,N as ee,x as h,H as v,I as y,F as g,y as k,aa as x,G as te,i as oe,B as le}from"./index-7e8465c2.js";import{_ as se}from"./DataTable.vue_vue_type_script_setup_true_lang-a5014fb4.js";import ne from"./SimpleModal-16734371.js";import{A as ae,E as ie}from"./clients.mutations-4a0a1e4b.js";import{h as re,o as ce,a as ue}from"./constants-71a97445.js";import{_ as de}from"./PageHeading.vue_vue_type_script_setup_true_lang-11482800.js";const me=t("hr",null,null,-1),fe={action:"post",class:"p-1"},pe={class:"grid grid-cols-2 gap-x-4 mb-4"},be={class:"block col-span-1 mb-2"},he=t("span",{class:"text-gray-700"},"Nombre",-1),ve={class:"block col-span-1 mb-2"},ge=t("span",{class:"text-gray-700"},"Email",-1),Ce={class:"block col-span-1 mb-2"},_e=t("span",{class:"text-gray-700"},"Telefono",-1),ye={class:"grid grid-cols-3 gap-x-4 mb-4"},ke={class:"block col-span-1 mb-2"},xe=t("span",{class:"text-gray-700"},"Pais",-1),De=t("option",null,null,-1),we=["value"],Ue={class:"block col-span-1 mb-2"},Pe=t("span",{class:"text-gray-700"},"Provincia",-1),Be=t("option",null,null,-1),Te=["value"],Ne={class:"block col-span-1 mb-2"},Me=t("span",{class:"text-gray-700"},"Distrito",-1),Ee=t("option",null,null,-1),Ie=["value"],Ae={class:"block col-span-1 mb-2"},Se=t("span",{class:"text-gray-700"},"Direccion",-1),Ve=t("hr",null,null,-1),He=Q({__name:"Clients",setup(Re){const c=z(),b=J(),{withClientMutation:D}=le(),M=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Nombre Cliente",value:"name",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(n,o){return W(X,{to:{name:"client-detail",query:{clientUid:n?.uid}},class:"px-2 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none",innerHTML:n.name})}},{name:"Codigo Cliente",value:"clienteId",sortable:!1,sortBy:"asc",hidden:!1},{name:"Pais",value:"district.province.country.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Provincia",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Distrito",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Numbero Telefono",value:"phoneMobile",sortable:!1,sortBy:"asc",hidden:!1},{name:"Direccion",value:"clienteDireccion",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:E,provinces:I,districts:A}=B(b),{clients:w,clientPageInfo:U,fetchingClients:S}=B(c);let m=u(!1),C=u(!1),V=u(""),l=T({});const P=u(""),R=()=>Object.assign(l,{});let a=T({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),f=u(),p=u();c.fetchClients(a),b.fetchCountries();function L(){D(ae,{payload:{name:l.name,districtUid:l.districtUid,email:l.email,phoneMobile:l.mobilePhone,clienteDireccion:l.clienteDireccion}},"createClient").then(n=>c.addClient(n))}function O(){D(ie,{uid:l.uid,payload:{name:l.name,districtUid:l.districtUid,email:l.email,phoneMobile:l.mobilePhone,clienteDirecion:l.clienteDireccion}},"updateClient").then(n=>c.updateClient(n))}function j(n){b.filterProvincesByCountry(f.value)}function F(n){b.filterDistrictsByProvince(p.value)}function $(n){a.first=100,a.after="",a.text=n.filterText,a.filterAction=!0,c.fetchClients(a)}function G(n){a.first=n.fetchCount,a.after=U?.value?.endCursor,a.text=n.filterText,a.filterAction=!1,c.fetchClients(a)}function H(n,o,e={}){C.value=n,V.value=o,P.value=(n?"CREAR":"EDITAR")+" "+o.toUpperCase(),o=="client"&&(m.value=!0),n?o=="client"&&Object.assign(l,{}):o=="client"&&Object.assign(l,{...e})}function q(){C.value&&L(),C.value||O(),m.value=!1}const K=Y(()=>w?.value?.length+" de "+c.getClientCount+" clientes");return(n,o)=>(i(),d(g,null,[N(de,{title:"Clientes"}),r(t("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:o[0]||(o[0]=e=>H(!0,"client"))}," Agregar Cliente ",512),[[Z,re(ue.CREATE,ce.CLIENT)]]),me,N(se,{columns:M.value,data:s(w),toggleColumns:!0,loading:s(S),paginable:!0,pageMeta:{fetchCount:s(a).first,hasNextPage:s(U)?.hasNextPage,countNone:K.value},searchable:!0,filterable:!1,onOnSearchKeyUp:$,onOnSearchFocus:R,onOnPaginate:G,selectable:!1},{footer:_(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),s(m)?(i(),ee(ne,{key:0,onClose:o[11]||(o[11]=e=>y(m)?m.value=!1:m=!1)},{header:_(()=>[t("h3",null,h(P.value),1)]),body:_(()=>[t("form",fe,[t("div",pe,[t("label",be,[he,r(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":o[1]||(o[1]=e=>s(l).name=e),placeholder:"Nombre ..."},null,512),[[v,s(l).name]])]),t("label",ve,[ge,r(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":o[2]||(o[2]=e=>s(l).email=e),placeholder:"Email ..."},null,512),[[v,s(l).email]])]),t("label",Ce,[_e,r(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":o[3]||(o[3]=e=>s(l).mobilePhone=e),placeholder:"Telefono ..."},null,512),[[v,s(l).mobilePhone]])])]),t("div",ye,[t("label",ke,[xe,r(t("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":o[4]||(o[4]=e=>y(f)?f.value=e:f=e),onChange:o[5]||(o[5]=e=>j(e))},[De,(i(!0),d(g,null,k(s(E),e=>(i(),d("option",{key:e.uid,value:e.uid},h(e.name),9,we))),128))],544),[[x,s(f)]])]),t("label",Ue,[Pe,r(t("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":o[6]||(o[6]=e=>y(p)?p.value=e:p=e),onChange:o[7]||(o[7]=e=>F(e))},[Be,(i(!0),d(g,null,k(s(I),e=>(i(),d("option",{key:e.uid,value:e.uid},h(e.name),9,Te))),128))],544),[[x,s(p)]])]),t("label",Ne,[Me,r(t("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":o[8]||(o[8]=e=>s(l).districtUid=e)},[Ee,(i(!0),d(g,null,k(s(A),e=>(i(),d("option",{key:e.uid,value:e.uid},h(e.name),9,Ie))),128))],512),[[x,s(l).districtUid]])])]),t("label",Ae,[Se,r(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":o[9]||(o[9]=e=>s(l).clienteDireccion=e),placeholder:"Direccion ..."},null,512),[[v,s(l).clienteDireccion]])]),Ve,t("button",{type:"button",onClick:o[10]||(o[10]=te(e=>q(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Guardar forma ")])]),_:1})):oe("",!0)],64))}});export{He as default};
