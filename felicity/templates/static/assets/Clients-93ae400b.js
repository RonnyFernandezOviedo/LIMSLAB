import{d as Q,ak as z,P as J,r as u,ai as W,aj as X,L as N,Q as T,t as Y,o as i,c,e as P,f,v as Z,b as s,w as g,u as n,N as ee,x as h,H as D,I as _,F as v,y,aa as k,G as te,i as se,B as oe}from"./index-b75e268d.js";import{_ as le}from"./DataTable.vue_vue_type_script_setup_true_lang-82b65dd3.js";import ne from"./SimpleModal-95440dc3.js";import{A as ae,E as ie}from"./clients.mutations-5b58380b.js";import{h as re,o as ue,a as ce}from"./constants-9fdeb32f.js";import{_ as de}from"./PageHeading.vue_vue_type_script_setup_true_lang-5ed2558e.js";const fe=s("hr",null,null,-1),me={action:"post",class:"p-1"},pe={class:"grid grid-cols-2 gap-x-4 mb-4"},be={class:"block col-span-1 mb-2"},he=s("span",{class:"text-gray-700"},"Nombre",-1),ve={class:"block col-span-1 mb-2"},Ce=s("span",{class:"text-gray-700"},"Codigo",-1),ge={class:"grid grid-cols-3 gap-x-4 mb-4"},_e={class:"block col-span-1 mb-2"},ye=s("span",{class:"text-gray-700"},"Pais",-1),ke=s("option",null,null,-1),xe=["value"],we={class:"block col-span-1 mb-2"},Ue=s("span",{class:"text-gray-700"},"Provincia",-1),Be=s("option",null,null,-1),Ne=["value"],Te={class:"block col-span-1 mb-2"},Pe=s("span",{class:"text-gray-700"},"Distrito",-1),De=s("option",null,null,-1),Ee=["value"],Ie=s("hr",null,null,-1),je=Q({__name:"Clients",setup(Ae){const r=z(),b=J(),{withClientMutation:x}=oe(),E=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Nombre Cliente",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,t){return W(X,{to:{name:"client-detail",query:{clientUid:o?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:o?.name})}},{name:"Codigo Cliente",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"Distrito",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Provincia",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Number Telefono",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:I,provinces:A,districts:M}=N(b),{clients:w,clientPageInfo:U,fetchingClients:S}=N(r);let d=u(!1),C=u(!1),R=u(""),l=T({});const B=u(""),L=()=>Object.assign(l,{});let a=T({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),m=u(),p=u();r.fetchClients(a),b.fetchCountries();function V(){x(ae,{payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"createClient").then(o=>r.addClient(o))}function O(){x(ie,{uid:l.uid,payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"updateClient").then(o=>r.updateClient(o))}function j(o){b.filterProvincesByCountry(m.value)}function F(o){b.filterDistrictsByProvince(p.value)}function $(o){a.first=100,a.after="",a.text=o.filterText,a.filterAction=!0,r.fetchClients(a)}function G(o){a.first=o.fetchCount,a.after=U?.value?.endCursor,a.text=o.filterText,a.filterAction=!1,r.fetchClients(a)}function H(o,t,e={}){C.value=o,R.value=t,B.value=(o?"CREAR":"EDITAR")+" "+t.toUpperCase(),t=="client"&&(d.value=!0),o?t=="client"&&Object.assign(l,{}):t=="client"&&Object.assign(l,{...e})}function q(){C.value&&V(),C.value||O(),d.value=!1}const K=Y(()=>w?.value?.length+" de "+r.getClientCount+" clientes");return(o,t)=>(i(),c(v,null,[P(de,{title:"Clientes"}),f(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:t[0]||(t[0]=e=>H(!0,"client"))}," Agregar Cliente ",512),[[Z,re(ce.CREATE,ue.CLIENT)]]),fe,P(le,{columns:E.value,data:n(w),toggleColumns:!0,loading:n(S),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(U)?.hasNextPage,countNone:K.value},searchable:!0,filterable:!1,onOnSearchKeyUp:$,onOnSearchFocus:L,onOnPaginate:G,selectable:!1},{footer:g(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),n(d)?(i(),ee(ne,{key:0,onClose:t[9]||(t[9]=e=>_(d)?d.value=!1:d=!1)},{header:g(()=>[s("h3",null,h(B.value),1)]),body:g(()=>[s("form",me,[s("div",pe,[s("label",be,[he,f(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=e=>n(l).name=e),placeholder:"Name ..."},null,512),[[D,n(l).name]])]),s("label",ve,[Ce,f(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[2]||(t[2]=e=>n(l).code=e),placeholder:"Code ..."},null,512),[[D,n(l).code]])])]),s("div",ge,[s("label",_e,[ye,f(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[3]||(t[3]=e=>_(m)?m.value=e:m=e),onChange:t[4]||(t[4]=e=>j(e))},[ke,(i(!0),c(v,null,y(n(I),e=>(i(),c("option",{key:e.uid,value:e.uid},h(e.name),9,xe))),128))],544),[[k,n(m)]])]),s("label",we,[Ue,f(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[5]||(t[5]=e=>_(p)?p.value=e:p=e),onChange:t[6]||(t[6]=e=>F(e))},[Be,(i(!0),c(v,null,y(n(A),e=>(i(),c("option",{key:e.uid,value:e.uid},h(e.name),9,Ne))),128))],544),[[k,n(p)]])]),s("label",Te,[Pe,f(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[7]||(t[7]=e=>n(l).districtUid=e)},[De,(i(!0),c(v,null,y(n(M),e=>(i(),c("option",{key:e.uid,value:e.uid},h(e.name),9,Ee))),128))],512),[[k,n(l).districtUid]])])]),Ie,s("button",{type:"button",onClick:t[8]||(t[8]=te(e=>q(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Guardar forma ")])]),_:1})):se("",!0)],64))}});export{je as default};
