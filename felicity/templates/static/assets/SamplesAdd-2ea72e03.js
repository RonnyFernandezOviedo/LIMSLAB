import{d as se,V as le,O as ae,a9 as oe,ak as ne,E as ie,t as u,Q as I,r as re,al as ce,o as n,c as i,b as e,f as c,H as V,u as o,I as m,x as r,e as T,aa as b,F as _,y as f,G as R,i as ue,z as de,B as pe,ah as me,am as _e,A as fe}from"./index-236e333a.js";import he from"./vue-multiselect.esm-db52f9c4.js";import{c as M,a as E,d as N,e as ve,u as ye,b as d}from"./array-324ecb18.js";/* empty css                                                                 */const we={class:"w-3/6 mt-4 py-4"},be=e("h5",{class:"mb-4"},"Agregar Solicitud de Analisis",-1),ge={class:""},xe={class:"flex whitespace-nowrap mb-2 w-full"},Se=e("span",{class:"text-gray-700 w-4/12"},"ID Muestra Cliente",-1),Ce={class:"w-full"},Ae={class:"text-orange-600 w-4/12"},ke={class:"flex whitespace-nowrap mb-2 w-full"},Ue=e("span",{class:"text-gray-700 w-4/12"},"Comentarios",-1),Ve={class:"w-full"},Re={class:"text-orange-600 w-4/12"},De={class:"flex whitespace-nowrap mb-2 w-full"},qe=e("span",{class:"text-gray-700 w-4/12"},"Cliente",-1),Pe={class:"w-full"},Ie={class:"flex whitespace-nowrap mb-2 w-full"},Te=e("span",{class:"text-gray-700 w-4/12"},"Contacto de Cliente",-1),Me={class:"w-full"},Ee=e("option",{value:""},null,-1),Ne=["value"],Be={class:"text-orange-600 w-4/12"},Fe={class:"flex whitespace-nowrap mb-2 w-full"},$e=e("span",{class:"text-gray-700 w-4/12"},"Prioridad",-1),Le={class:"w-full"},je={class:"text-orange-600 w-4/12"},Oe={id:"samples"},Qe=e("hr",null,null,-1),ze={class:"flex justify-between items-center py-2"},Ge=e("h5",null,"Muestras",-1),He={class:"text-orange-600"},Ye=e("hr",{class:"mb-4"},null,-1),Je={class:"flex items-center justify-between"},Ke={class:"flex items-top gap-x-4"},We={class:"flex flex-col whitespace-nowrap mb-2"},Xe=e("span",{class:"text-gray-700"},"Tipo de Muestra",-1),Ze=["onUpdate:modelValue"],et=e("option",{value:""},null,-1),tt=["value"],st={class:"flex flex-col whitespace-nowrap mb-2"},lt=e("span",{class:"text-gray-700"},"Perfil de Analisis",-1),at=["onUpdate:modelValue"],ot=e("option",{value:""},null,-1),nt=["value"],it={class:"flex flex-col whitespace-nowrap mb-2"},rt=e("span",{class:"text-gray-700"},"Analisis",-1),ct=["onUpdate:modelValue"],ut=e("option",{value:""},null,-1),dt=["value"],pt={class:""},mt=["onClick"],_t=e("hr",null,null,-1),ft=e("hr",null,null,-1),ht={key:0,type:"submit",class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"},vt={key:1,class:"py-4 text-center"},St=se({__name:"SamplesAdd",setup(yt){const B=de(()=>fe(()=>import("./LoadingMessage-80ee7b63.js"),["assets/LoadingMessage-80ee7b63.js","assets/LoadingMessage.vue_vue_type_script_setup_true_lang-f84223a1.js","assets/index-236e333a.js","assets/index-a964bbb1.css"])),g=le(),F=ae(),h=oe(),v=ne(),$=ie(),{withClientMutation:L}=pe(),{swalError:D}=me();let q=u(()=>F.getPatient),j=I({first:void 0,after:"",text:"",sortBy:["name"]});v.fetchClients(j);const O=u(()=>v.getClients);function Q(a){_e(a)&&v.fetchClientContacts(a?.uid)}const z=u(()=>v.getClientContacts);g.fetchSampleTypes();const G=u(()=>g.getSampleTypes);let H=I({first:void 0,after:"",text:"",sortBy:["name"]});h.fetchAnalysesServices(H);const Y=u(()=>{const a=h.getAnalysesServicesSimple;let s=new Set;return a.forEach((t,U)=>{t.profiles?.length===0&&s.add(t)}),[...s]});h.fetchAnalysesProfiles();const J=u(()=>h.getAnalysesProfiles),x=re(!1),K=M({clientRequestId:E().required("Cliente ID es requerido"),clinicalData:E().nullable(),client:M().required("Cliente es requerido"),clientContactUid:N().required("Contacto de cliente es requerido"),samples:ve().required().min(1,"Agregue al menos 1 muestra"),priority:N()}),{handleSubmit:W,errors:p}=ye({validationSchema:K,initialValues:{priority:0,samples:[]}}),{value:S}=d("clientRequestId"),{value:C}=d("clinicalData"),{value:y}=d("client"),{value:A}=d("clientContactUid"),{value:k}=d("priority"),{value:w}=d("samples"),P=W(a=>{x.value=!0;for(let s of a.samples||[]){if(typeof s?.sampleType!="string"){D("Samples must have sample types");return}if(s?.analyses?.length<=0&&s?.profiles?.length<=0){D("Samples must have either profiles/analyses or both");return}}X(a)});function X(a){const s={patientUid:q.value?.uid,clientRequestId:a.clientRequestId,clinicalData:a.clinicalData,clientUid:y?.value?.uid,clientContactUid:a.clientContactUid,samples:a.samples};L(ce,{payload:s},"createAnalysisRequest").then(t=>{g.addAnalysisRequest(t),$.push({name:"patient-detail",params:{patientUid:q.value?.uid}})}).finally(()=>{x.value=!1})}function Z(){const a={sampleType:{},profiles:[],analyses:[]};w.value.push(a)}function ee(a){w.value.splice(a,1)}return(a,s)=>(n(),i("div",we,[be,e("form",{action:"post",class:"p-4 mb-8 bg-white",onSubmit:s[6]||(s[6]=R((...t)=>o(P)&&o(P)(...t),["prevent"]))},[e("div",ge,[e("label",xe,[Se,e("div",Ce,[c(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":s[0]||(s[0]=t=>m(S)?S.value=t:null),placeholder:"ID ..."},null,512),[[V,o(S)]]),e("div",Ae,r(o(p).clientRequestId),1)])]),e("label",ke,[Ue,e("div",Ve,[c(e("textarea",{cols:"2",class:"form-input mt-1 w-full","onUpdate:modelValue":s[1]||(s[1]=t=>m(C)?C.value=t:null),placeholder:"Comentarios ..."},null,512),[[V,o(C)]]),e("div",Re,r(o(p).clinicalData),1)])]),e("label",De,[qe,e("div",Pe,[T(o(he),{placeholder:"Select a Client",modelValue:o(y),"onUpdate:modelValue":s[2]||(s[2]=t=>m(y)?y.value=t:null),options:O.value,searchable:!0,label:"name","track-by":"uid",onSelect:Q},null,8,["modelValue","options"])])]),e("label",Ie,[Te,e("div",Me,[c(e("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":s[3]||(s[3]=t=>m(A)?A.value=t:null),class:"form-input mt-1 block w-full"},[Ee,(n(!0),i(_,null,f(z.value,t=>(n(),i("option",{key:t.uid,value:t.uid},r(t.firstName)+" "+r(t.lastName),9,Ne))),128))],512),[[b,o(A)]]),e("div",Be,r(o(p).clientContactUid),1)])]),e("label",Fe,[$e,e("div",Le,[c(e("input",{type:"number",min:"0",max:"2",class:"form-input mt-1 block w-full","onUpdate:modelValue":s[4]||(s[4]=t=>m(k)?k.value=t:null)},null,512),[[V,o(k)]]),e("div",je,r(o(p).priority),1)])])]),e("section",Oe,[Qe,e("div",ze,[Ge,e("span",He,r(o(p).samples),1),o(w)?.length!==20?(n(),i("button",{key:0,onClick:s[5]||(s[5]=R(t=>Z(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800rounded-smtransition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Agregar Muestra ")):ue("",!0)]),Ye,(n(!0),i(_,null,f(o(w),(t,U)=>(n(),i("div",{key:U},[e("div",Je,[e("div",Ke,[e("label",We,[Xe,c(e("select",{name:"sampleTypes",id:"sampleTypes","onUpdate:modelValue":l=>t.sampleType=l,class:"form-input mt-1"},[et,(n(!0),i(_,null,f(G.value,l=>(n(),i("option",{key:l.uid,value:l.uid},r(l.name),9,tt))),128))],8,Ze),[[b,t.sampleType]])]),e("label",st,[lt,c(e("select",{name:"analysisProfiles",id:"analysisProfiles","onUpdate:modelValue":l=>t.profiles=l,class:"form-input mt-1",multiple:""},[ot,(n(!0),i(_,null,f(J.value,(l,te)=>(n(),i("option",{key:l.uid,value:l.uid},r(l.name),9,nt))),128))],8,at),[[b,t.profiles]])]),e("label",it,[rt,c(e("select",{name:"analysesServices",id:"analysesServices","onUpdate:modelValue":l=>t.analyses=l,class:"form-input mt-1",multiple:""},[ut,(n(!0),i(_,null,f(Y.value,(l,te)=>(n(),i("option",{key:l.uid,value:l.uid},r(l.name),9,dt))),128))],8,ct),[[b,t.analyses]])])]),e("div",pt,[e("button",{onClick:R(l=>ee(U),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remover ",8,mt)])]),_t]))),128))]),ft,x.value?(n(),i("div",vt,[T(o(B),{message:"Agregando Muestras ..."})])):(n(),i("button",ht," Agregar muestra(s) "))],32)]))}});export{St as default};
