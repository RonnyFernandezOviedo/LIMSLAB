import{d as R,ar as U,aI as V,aJ as E,L as O,t as j,M as C,o as n,c as a,u as p,e as F,f as M,F as g,y as m,b as o,x as _,h,aq as d,z as P,A as q}from"./index-236e333a.js";const J={class:"relative mt-4"},G=o("div",{class:"border-r-2 border-gray-400 border-dotted absolute h-full top-0 z-0",style:{left:"7px"}},null,-1),H={key:0,class:"py-4 text-center"},K={key:1,initial:{opacity:0,y:100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:200,class:"list-none m-0 p-0"},Q={class:"flex items-center mb-1"},W=o("div",{class:"bg-indigo-600 rounded-full h-4 w-4 border-gray-200 border-2 z-10"},null,-1),X={class:"ml-4 font-medium italic"},Y={class:"ml-12 w-100"},Z={class:"col-span-1"},$={class:"text-sm text-gray-600 italic"},y={class:"col-span-3"},B={class:"text-muted text-xs text-orange-600"},v={class:"text-muted text-xs text-sky-800"},A=R({__name:"AuditLog",props:{targetId:String,targetType:String},setup(b){const x=P(()=>q(()=>import("./LoadingMessage-80ee7b63.js"),["assets/LoadingMessage-80ee7b63.js","assets/LoadingMessage.vue_vue_type_script_setup_true_lang-f84223a1.js","assets/index-236e333a.js","assets/index-a964bbb1.css"])),S=b,{targetType:L,targetId:w}=U(S),l=V(),u=E();u.restLogs();const{auditLogs:z,fetchingAudits:I}=O(u);l.fetchUsers({}),u.fetchAuditLogs({targetType:L?.value,targetId:w?.value});let T=j(()=>l.getUsers);function i(r){const c=T?.value?.find(f=>f.uid?.toString()===r?.toString());return c?c.auth.userName:""}function D(r){return r===1?"creado":r===2?"actualizo":r===3?"borrado":""}function N(r){let c=new Set;return Object.entries(r?.stateBefore)?.map(([f,e])=>{Object.entries(r?.stateAfter)?.map(([t,s])=>{f===t&&e!==s&&(t&&t==="updated_by_uid"&&(t="actualizado_por",e=i(e),s=i(s)),t&&t==="submitted_by_uid"&&(t="cargado_por",e=i(e),s=i(s)),t&&t==="verified_by_uid"&&(t="verificado_por",e=i(e),s=i(s)),t&&t==="updated_at"&&(t="actualizado_el",e=d(e),s=d(s)),t&&t==="cancelled_by_uid"&&(t="cancelado_por",e=i(e),s=i(s)),t&&t==="received_by_uid"&&(t="recibido_por",e=i(e),s=i(s)),t&&t==="published_by_uid"&&(t="publicado_por",e=i(e),s=i(s)),t&&t==="status"&&(t="cambio_estado"),t&&t==="date_received"&&(t="fecha_recibido",s=d(s)),t&&t==="date_submitted"&&(t="fecha_carga",s=d(s)),t&&t==="date_verified"&&(t="fecha_verificacion",s=d(s)),t&&t==="date_published"&&(t="fecha_publicacion",s=d(s)),c.add({key:t,old:e?.length>0?e:"",new:s?.toString()?.length>0?s:"Ninguna"}))})}),c}return(r,c)=>{const f=C("motion");return n(),a("div",J,[G,p(I)?(n(),a("div",H,[F(p(x),{message:"Recopilando audit logs ..."})])):M((n(),a("ul",K,[(n(!0),a(g,null,m(p(z),e=>(n(),a("li",{key:e.uid,class:"mb-2"},[o("div",Q,[W,o("div",X,[o("span",null,_(i(e?.userId))+" "+_(D(e?.action))+" ",1),h("la muestra el "),o("span",null,_(p(d)(e?.stateAfter?.updated_at)),1)])]),o("div",Y,[(n(!0),a(g,null,m(N(e),t=>(n(),a("div",{key:t.key,class:"grid grid-cols-4"},[o("span",Z,[o("span",$,_(t?.key),1)]),o("span",y,[o("span",B,_(t?.old),1),h(" â†’ "),o("span",v,_(t?.new),1)])]))),128))])]))),128))])),[[f]])])}}});export{A as _};
