import{d as le,af as ce,V as ie,L as de,Q as ue,s as _e,D as pe,a as he,M as ye,o,c as r,b as e,u as T,e as d,f as c,ab as N,F as V,y as P,n as be,N as M,i as B,x as u,H as fe,aa as ge,v as y,w as b,h as f,G as g,z as me,A as xe,aX as F,t as ke}from"./index-7fd050f3.js";import m from"./Button-a1d85628.js";import{u as ve}from"./analysis-937e6e00.js";import{h as x,o as k,a as v}from"./constants-df8aad36.js";const we=e("hr",{class:"mt-4 mb-2"},null,-1),Re=e("h3",{class:"font-bold"},"Analisis/Resultados",-1),Ce=e("hr",{class:"mb-4 mt-2"},null,-1),Ue={class:"overflow-x-auto"},Ee={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-white shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},Ae={key:0,class:"py-4 text-center"},Se={key:1,class:"min-w-full"},Te={class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},Ve=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},null,-1),De=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"}," Analisis ",-1),Le=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Metodo ",-1),Ne=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Instrumento ",-1),Pe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Analista ",-1),Me=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Resultado ",-1),Be=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Re-Analizado ",-1),Fe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Enviado ",-1),Ie=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Fecha Vencimiento ",-1),ze=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Estado ",-1),Oe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reportable ",-1),Ke=e("th",{class:"px-1 py-1 border-b-2 border-gray-300"},null,-1),$e={class:"bg-white"},qe=["onUpdate:modelValue","onChange","disabled"],je=e("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},null,-1),Ge={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},He={class:"text-sm leading-5 text-sky-800 font-semibold"},Qe={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},We={class:"text-sm leading-5 text-sky-800"},Xe={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Je={class:"text-sm leading-5 text-sky-800"},Ye={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ze={class:"text-sm leading-5 text-sky-800"},et={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},tt={key:0,class:"text-sm leading-5 text-sky-800"},st={key:1,class:"block"},at=["onUpdate:modelValue","onKeyup"],nt={key:2,class:"block col-span-2 mb-2"},ot=["onUpdate:modelValue","onChange"],rt=e("option",{value:""},null,-1),lt=["value"],ct={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},it={class:"text-sm leading-5 text-sky-800"},dt={key:0,class:"text-sky-800"},ut=e("i",{class:"fa fa-check-circle","aria-hidden":"true"},null,-1),_t=[ut],pt={key:1,class:"text-orange-600"},ht=e("i",{class:"fa fa-times-circle","aria-hidden":"true"},null,-1),yt=[ht],bt=e("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},[e("div",{class:"text-sm leading-5 text-sky-800"},"2020-10-10")],-1),ft=e("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},[e("div",{class:"text-sm leading-5 text-sky-800"},"2020-10-10")],-1),gt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},mt={type:"button",class:"bg-sky-800 text-white px-2 py-1 rounded-sm leading-none"},xt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},kt={class:"text-sm leading-5 text-sky-800"},vt={key:0,class:"text-emerald-600"},wt=e("i",{class:"fa fa-thumbs-up","aria-hidden":"true"},null,-1),Rt=[wt],Ct={key:1,class:"text-orange-600"},Ut=e("i",{class:"fa fa-thumbs-down","aria-hidden":"true"},null,-1),Et=[Ut],At=e("td",{class:"px-1 py-1 whitespace-no-wrap text-right border-b border-gray-500 text-sm leading-5"},null,-1),St={class:"my-4"},Mt=le({__name:"Results",setup(Tt){const I=me(()=>xe(()=>import("./LoadingMessage-42d5345f.js"),["assets/LoadingMessage-42d5345f.js","assets/LoadingMessage.vue_vue_type_script_setup_true_lang-24b3949b.js","assets/index-7fd050f3.js","assets/index-a964bbb1.css"])),E=ce(),_=ie(),{sample:U,analysisResults:w,fetchingResults:z}=de(_),a=ue({can_submit:!1,can_cancel:!1,can_retract:!1,can_approve:!1,can_retest:!1,can_reinstate:!1,allChecked:!1});_e(()=>_.fetchAnalysisResultsForSample(E.params.sampleUid)),pe(()=>E.params.sampleUid,(t,n)=>{_.resetSample(),_.fetchAnalysisResultsForSample(E.params.sampleUid)});function A(){let t=[];return w?.value?.forEach(n=>{n.checked&&t.push(n)}),t}function O(){let t=A(),n=[];return t?.forEach(i=>n.push({uid:i.uid,result:i.result})),n}function R(){const t=A();let n=[];return t?.forEach(i=>n.push(i.uid)),n}function K(t){q()?a.allChecked=!0:a.allChecked=!1,C()}function S(t){L(t)||(t.checked=!0,C())}function D(t){t.checked=!1,C()}async function $(){await w?.value?.forEach(t=>a.allChecked?S(t):D(t)),C()}async function p(){await w?.value?.forEach(t=>D(t)),C()}function q(){return w?.value?.every(t=>t.checked===!0)}function L(t){switch(t?.status){case"retracted":return!0;case"aprobada":return!0;case"cancelada":return U?.value?.status!=="recibido";default:return!1}}function j(t){t.editable=!0}function G(t){return!["recibido","paired"].includes(U?.value?.status??"")||t.status!=="pendiente"?!1:t?.editable||F(t?.result)?(j(t),!0):!1}function H(t){switch(t?.status){case"retracted":return"bg-gray-300";case"aproved":return t?.reportable===!1?"bg-orange-600":"";default:return""}}function C(){a.can_cancel=!1,a.can_submit=!1,a.can_retract=!1,a.can_approve=!1,a.can_retest=!1,a.can_reinstate=!1;const t=A();t.length!==0&&(t.every(n=>n.status==="cancelada")&&(a.can_reinstate=!0),t.every(n=>n.status==="pendiente")&&(a.can_cancel=!0),t.every(n=>["pendiente"].includes(n.status??"")&&!F(n.result))&&(a.can_submit=!0),t.every(n=>n.status==="resultado")&&(a.can_retract=!0,a.can_approve=!0,a.can_retest=!0))}const h=async()=>{const t=ke(()=>_.getSample);t.value&&_.fetchSampleStatus(t?.value?.uid)};let{submitResults:Q,cancelResults:W,reInstateResults:X,approveResults:J,retractResults:Y,retestResults:Z}=ve();const ee=()=>Q(O(),"sample",U?.value?.uid).then(()=>h()).finally(()=>p()),te=()=>W(R()).then(()=>h()).finally(()=>p()),se=()=>X(R()).then(()=>h()).finally(()=>p()),ae=()=>J(R(),"sample",U?.value?.uid).then(()=>h()).finally(()=>p()),ne=()=>Y(R()).then(()=>h()).finally(()=>p()),oe=()=>Z(R()).then(()=>h()).finally(()=>p());return(t,n)=>{const i=he("font-awesome-icon"),re=ye("motion-slide-right");return o(),r(V,null,[we,Re,Ce,e("div",Ue,[e("div",Ee,[T(z)?(o(),r("div",Ae,[d(T(I),{message:"Recopilando Analisis ..."})])):(o(),r("table",Se,[e("thead",null,[e("tr",null,[e("th",Te,[c(e("input",{type:"checkbox",class:"",onChange:$,"onUpdate:modelValue":n[0]||(n[0]=s=>a.allChecked=s)},null,544),[[N,a.allChecked]])]),Ve,De,Le,Ne,Pe,Me,Be,Fe,Ie,ze,Oe,Ke])]),e("tbody",$e,[(o(!0),r(V,null,P(T(w),s=>c((o(),r("tr",{key:s.uid,class:be([H(s)])},[e("td",null,[c(e("input",{type:"checkbox",class:"border-red-500","onUpdate:modelValue":l=>s.checked=l,onChange:l=>K(),disabled:L(s)},null,40,qe),[[N,s.checked]]),s.status==="pending"?(o(),M(i,{key:0,icon:"fa-question",class:"ml-1 text-xs"})):B("",!0),s.status==="resulted"?(o(),M(i,{key:1,icon:"fa-question",class:"ml-1 text-xs text-orange"})):B("",!0)]),je,e("td",Ge,[e("div",He,u(s.analysis?.name),1)]),e("td",Qe,[e("div",We,u(s.method?.name||"None"),1)]),e("td",Xe,[e("div",Je,u(s.instrument?.name||"None"),1)]),e("td",Ye,[e("div",Ze,u(s.analyst?.name||"None"),1)]),e("td",et,[G(s)?s?.analysis?.resultOptions?.length===0?(o(),r("label",st,[c(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>s.result=l,onKeyup:l=>S(s)},null,40,at),[[fe,s.result]])])):(o(),r("label",nt,[c(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>s.result=l,onChange:l=>S(s)},[rt,(o(!0),r(V,null,P(s?.analysis?.resultOptions,(l,Vt)=>(o(),r("option",{key:l.optionKey,value:l.value},u(l.value),9,lt))),128))],40,ot),[[ge,s.result]])])):(o(),r("div",tt,u(s?.result),1))]),e("td",ct,[e("div",it,[s?.retest?(o(),r("span",dt,_t)):(o(),r("span",pt,yt))])]),bt,ft,e("td",gt,[e("button",mt,u(s.status),1)]),e("td",xt,[e("div",kt,[s?.reportable?(o(),r("span",vt,Rt)):(o(),r("span",Ct,Et))])]),At],2)),[[re]])),128))])]))])]),e("section",St,[c(d(m,{key:"cancel",onClick:g(te,["prevent"]),color:"sky-800"},{default:b(()=>[f("Cancelar")]),_:1},512),[[y,x(v.UPDATE,k.RESULT)&&a.can_cancel]]),c(d(m,{key:"reinstate",onClick:g(se,["prevent"]),color:"orange-600"},{default:b(()=>[f("Re-Instegrar")]),_:1},512),[[y,x(v.UPDATE,k.RESULT)&&a.can_reinstate]]),c(d(m,{key:"submit",onClick:g(ee,["prevent"]),color:"orange-600"},{default:b(()=>[f("Cargar")]),_:1},512),[[y,x(v.UPDATE,k.RESULT)&&a.can_submit]]),c(d(m,{key:"retract",onClick:g(ne,["prevent"]),color:"orange-600"},{default:b(()=>[f("Retirar")]),_:1},512),[[y,x(v.UPDATE,k.RESULT)&&a.can_retract]]),c(d(m,{key:"verify",onClick:g(ae,["prevent"]),color:"orange-600"},{default:b(()=>[f("Verificar")]),_:1},512),[[y,x(v.UPDATE,k.RESULT)&&a.can_approve]]),c(d(m,{key:"retest",onClick:g(oe,["prevent"]),color:"orange-600"},{default:b(()=>[f("Re-Analizar")]),_:1},512),[[y,x(v.UPDATE,k.RESULT)&&a.can_retest]])])],64)}}});export{Mt as default};
