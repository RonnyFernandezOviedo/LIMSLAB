import{d as D,ar as R,aI as U,aJ as V,L as E,t as O,M as j,o as n,c as a,u as l,e as C,f as F,F as g,y as m,b as o,x as c,h,aq as u,z as M,A as P}from"./index-60c5f486.js";const q={class:"relative mt-4"},J=o("div",{class:"border-r-2 border-gray-400 border-dotted absolute h-full top-0 z-0",style:{left:"7px"}},null,-1),G={key:0,class:"py-4 text-center"},H={key:1,initial:{opacity:0,y:100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:200,class:"list-none m-0 p-0"},K={class:"flex items-center mb-1"},Q=o("div",{class:"bg-indigo-600 rounded-full h-4 w-4 border-gray-200 border-2 z-10"},null,-1),W={class:"ml-4 font-medium italic"},X={class:"ml-12 w-100"},Y={class:"col-span-1"},Z={class:"text-sm text-gray-600 italic"},$={class:"col-span-3"},v={class:"text-muted text-xs text-orange-600"},k={class:"text-muted text-xs text-sky-800"},A=D({__name:"AuditLog",props:{targetId:String,targetType:String},setup(b){const x=M(()=>P(()=>import("./LoadingMessage-eb65d708.js"),["assets/LoadingMessage-eb65d708.js","assets/LoadingMessage.vue_vue_type_script_setup_true_lang-57337f08.js","assets/index-60c5f486.js","assets/index-a964bbb1.css"])),S=b,{targetType:y,targetId:L}=R(S),f=U(),p=V();p.restLogs();const{auditLogs:w,fetchingAudits:z}=E(p);f.fetchUsers({}),p.fetchAuditLogs({targetType:y?.value,targetId:L?.value});let I=O(()=>f.getUsers);function r(i){const d=I?.value?.find(_=>_.uid?.toString()===i?.toString());return d?d.auth.userName:""}function N(i){return i===1?"creado":i===2?"actualizo":i===3?"borrado":""}function T(i){let d=new Set;return Object.entries(i?.stateBefore)?.map(([_,s])=>{Object.entries(i?.stateAfter)?.map(([t,e])=>{_===t&&s!==e&&(t&&t==="updated_by_uid"&&(t="actualizado_por",s=r(s),e=r(e)),t&&t==="submitted_by_uid"&&(t="cargado_por",s=r(s),e=r(e)),t&&t==="verified_by_uid"&&(t="verificado_por",s=r(s),e=r(e)),t&&t==="updated_at"&&(t="actualizado_el",s=u(s),e=u(e)),t&&t==="cancelled_by_uid"&&(t="cancelado_por",s=r(s),e=r(e)),t&&t==="received_by_uid"&&(t="recibido_por",s=r(s),e=r(e)),d.add({key:t,old:s?.length>0?s:"Ninguna",new:e?.toString()?.length>0?e:"Ninguna"}))})}),d}return(i,d)=>{const _=j("motion");return n(),a("div",q,[J,l(z)?(n(),a("div",G,[C(l(x),{message:"Recopilando audit logs ..."})])):F((n(),a("ul",H,[(n(!0),a(g,null,m(l(w),s=>(n(),a("li",{key:s.uid,class:"mb-2"},[o("div",K,[Q,o("div",W,[o("span",null,c(r(s?.userId))+" "+c(N(s?.action))+" ",1),h("la muestra el "),o("span",null,c(l(u)(s?.stateAfter?.updated_at)),1)])]),o("div",X,[(n(!0),a(g,null,m(T(s),t=>(n(),a("div",{key:t.key,class:"grid grid-cols-4"},[o("span",Y,[o("span",Z,c(t?.key),1)]),o("span",$,[o("span",v,c(t?.old),1),h(" â†’ "),o("span",k,c(t?.new),1)])]))),128))])]))),128))])),[[_]])])}}});export{A as _};
